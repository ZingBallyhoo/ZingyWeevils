@page "/"
@using Microsoft.AspNetCore.Identity
@using Microsoft.Extensions.Options
@using WeevilWorld.Server
@attribute [ResponseCache(Duration = 60*60*60)]
@inject IOptionsSnapshot<IdentityOptions> IdentityOptions

@{
    var allowedUsernameChars = IdentityOptions.Value.User.AllowedUserNameCharacters;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bin Weevils by Zingy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.ico" asp-append-version="true">
    <meta property="og:title" content="Bin Weevils" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="@HttpContext.AddFileVersionToPath("images/logo.jpg")" />
    <meta property="og:description" content="Bin Weevils by Zingy" />
    <meta name="description" content="Bin Weevils by Zingy">
    <style>
        html {
            position: relative;
            min-height: 100%;
        }
        body {
            margin-bottom: 70px !important; /* Margin bottom by footer height */
            background-image: linear-gradient(rgb(0 0 0 / 80%), rgb(0 0 0 / 90%)), url(@HttpContext.AddFileVersionToPath("images/bg.jpg"));
            background-position: center top;
            background-size: cover;
        }
        .header {
            justify-content: center;
            background-color: #303030;
        }
        .footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 60px; /* Set the fixed height of the footer here */
            line-height: 60px; /* Vertically center the text there */
            background-color: #305214;
        }
        .poggers-row {
            margin-right: 0 !important;
            padding-left: 15px !important;
        }
        .disclaimer-text {
        }
        @@media (max-width: 616px) {
            .hero-sub-text { font-size:1rem; }
            .hero-container { min-width: 310px; }
            .disclaimer-text { font-size: 0.5rem }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.6.0/darkly/bootstrap.min.css" integrity="sha512-A/WvCV75maYUI3F3yjeSqYg0dUIepPRx14Qw8EZjJ/udG5/s3uDWLHnm1FSbYzrJg4RLdAdEm/f6+1V6AxCBJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", (event) => {
            // restore the input to whatever was set previously
            const cookieValue = document.cookie
                .split("; ")
                .find((row) => row.startsWith("username="))
                ?.split("=")[1];

            if (cookieValue) {
                let input = document.getElementById("username-input");
                input.value = decodeURIComponent(cookieValue);
            }
        });
        
        function filterUsernameInput(event) {
            event = event || window.event;
            if (!"@allowedUsernameChars".includes(event.key)) {
                event.preventDefault();
            }
        }
    </script>
</head>
<body>
<div>
    <div class="align-items-center row poggers-row header">
        <div class="col text-right"><img src="images/logo.svg" alt="Bin Weevils Logo" width="95" height="95" asp-append-version="true"></div>
        <div class="col-auto" style="font-size: 5rem">+</div>
        <div class="col">
            <a href="https://github.com/zingballyhoo">
                <img src="https://avatars.githubusercontent.com/u/13888932?v=4" alt="Zingy Avatar" width="75" height="75">
            </a>
        </div>
    </div>
    <div class="row-auto text-center p-5" style="font-size: 1.25rem">
        There is no proper account system, simply choose a username.<br>
        NOTE: Account data may not be kept forever.
    </div>
    <div class="row no-gutters justify-content-center p-5">
        <form class="col-auto" method="post" asp-antiforgery="false" autocomplete="off">
            <div class="form-row">
                <input id="username-input" type="text" class="form-control form-control-lg mb-2" name="username" 
                       placeholder="fairriver5" onkeypress="filterUsernameInput()" maxlength="20">
            </div>
            <div class="form-row">
                <button type="submit" class="btn btn-block btn-primary mb-2">Play</button>
            </div>
        </form>
    </div>
    <div class="row-auto text-center p-5" style="font-size: 1rem">
        Current Quirks:<br>
        Some sounds can be way too loud. (e.g gaining mulch)<br>
        Weevil Wheels racing is super slow. <a href="https://github.com/ruffle-rs/ruffle/pull/20054">Pending Ruffle fix.</a><br>
        Weevil Wheels multiplayer is not finished.<br>
        Finishing a game of Spot the Difference will permanently break your client.<br>
        Clicking a news stand will crash the game.<br>
    </div>
</div>
<div class="footer">
    <div class="row poggers-row justify-content-center">
        <div class="text-center disclaimer-text">This site is a fan-run revival and is not associated with 55 Pixels Ltd or Lost Penguin Ltd</div>
    </div>
</div>
</body>
</html>